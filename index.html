<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPA Calculator by RandunLabz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Animation for adding/removing courses */
        @keyframes slideInFade {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        .course-add-animation {
            animation: slideInFade 0.4s ease-out forwards;
        }

        @keyframes slideOutFade {
            from { opacity: 1; transform: scale(1); }
            to { opacity: 0; transform: scale(0.95); height: 0; margin-bottom: 0; padding-top: 0; padding-bottom: 0; border-width: 0;}
        }
        .course-remove-animation {
            animation: slideOutFade 0.3s ease-in forwards;
            overflow: hidden;
        }

        /* Animation for GPA update */
        @keyframes gpa-pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .gpa-updated {
            animation: gpa-pop 0.3s ease-out;
        }

        /* Custom button style */
        .btn-primary {
            background-image: linear-gradient(to right, #8e2de2 0%, #4a00e0 100%);
            transition: all 0.3s ease;
            transform: scale(1);
        }
        .btn-primary:hover {
            box-shadow: 0 10px 20px -10px rgba(74, 0, 224, 0.5);
            transform: scale(1.02);
        }
        .btn-primary:active {
            transform: scale(0.98);
        }
        
        /* Custom select dropdown arrow */
        select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1.2em;
        }

    </style>
</head>
<body class="text-white">

    <div class="container mx-auto px-4 py-8 md:py-12 max-w-5xl min-h-screen flex flex-col">

        <!-- Header -->
        <header class="text-center mb-8 md:mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-white drop-shadow-lg">GPA Calculator</h1>
            <p class="text-slate-200/80 mt-2">A modern tool to calculate your GPA with ease.</p>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-3 gap-8 flex-grow">

            <!-- Left Column: Input Form & GPA Display -->
            <div class="lg:col-span-1 space-y-8">
                
                <!-- Input Form -->
                <div class="glass-card p-6 rounded-2xl shadow-2xl">
                    <h2 class="text-xl font-semibold mb-4 text-white">Add New Course</h2>
                    <form id="course-form" class="space-y-4">
                        <div>
                            <label for="course-name" class="block text-sm font-medium text-slate-200/90">Course Name</label>
                            <input type="text" id="course-name" placeholder="e.g., Quantum Physics" class="mt-1 block w-full px-3 py-2 bg-white/10 border border-white/20 rounded-md text-sm shadow-sm placeholder-slate-200/50 text-white focus:outline-none focus:border-white/50 focus:ring-1 focus:ring-white/50">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label for="credits" class="block text-sm font-medium text-slate-200/90">Credits</label>
                                <input type="number" id="credits" placeholder="3" min="0.5" step="0.5" required class="mt-1 block w-full px-3 py-2 bg-white/10 border border-white/20 rounded-md text-sm shadow-sm placeholder-slate-200/50 text-white focus:outline-none focus:border-white/50 focus:ring-1 focus:ring-white/50">
                            </div>
                            <div>
                                <label for="grade" class="block text-sm font-medium text-slate-200/90">Grade</label>
                                <select id="grade" required class="mt-1 block w-full px-3 py-2 bg-white/10 border border-white/20 rounded-md text-sm shadow-sm text-white focus:outline-none focus:border-white/50 focus:ring-1 focus:ring-white/50">
                                    <option class="text-black" value="A+">A+</option>
                                    <option class="text-black" value="A">A</option>
                                    <option class="text-black" value="A-">A-</option>
                                    <option class="text-black" value="B+">B+</option>
                                    <option class="text-black" value="B">B</option>
                                    <option class="text-black" value="B-">B-</option>
                                    <option class="text-black" value="C+">C+</option>
                                    <option class="text-black" value="C">C</option>
                                    <option class="text-black" value="C-">C-</option>
                                    <option class="text-black" value="D+">D+</option>
                                    <option class="text-black" value="D">D</option>
                                    <option class="text-black" value="F">F</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="w-full btn-primary text-white font-semibold py-2.5 px-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-white/50 focus:ring-offset-2 focus:ring-offset-transparent">
                            Add Course
                        </button>
                    </form>
                </div>

                <!-- GPA Display -->
                <div class="glass-card p-6 rounded-2xl shadow-2xl text-center">
                    <h2 class="text-lg font-medium text-slate-200/80">Cumulative GPA</h2>
                    <div id="gpa-display" class="gpa-display text-7xl font-bold text-white my-2 drop-shadow-md">0.00</div>
                    <p id="gpa-summary" class="text-slate-200/80 text-sm">Based on 0 credits</p>
                    <button id="download-pdf-btn" class="mt-4 w-full bg-cyan-400/20 text-cyan-300 font-semibold py-2 px-4 rounded-lg border border-cyan-400/30 hover:bg-cyan-400/30 hover:text-white transition-all duration-300">
                        Download Report
                    </button>
                </div>

            </div>

            <!-- Right Column: Course List -->
            <div class="lg:col-span-2">
                <div id="course-list-container" class="glass-card p-6 rounded-2xl shadow-2xl min-h-[400px]">
                    <h2 class="text-xl font-semibold mb-4 border-b border-white/20 pb-3 text-white">Course List</h2>
                    <div id="course-list" class="space-y-3 mt-4">
                        <div id="empty-state" class="text-center py-16 px-4">
                            <svg class="mx-auto h-12 w-12 text-white/50" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
                            </svg>
                            <h3 class="mt-4 text-sm font-semibold text-slate-200">Your courses will appear here</h3>
                            <p class="mt-1 text-sm text-slate-200/70">Add a course using the form on the left.</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- Footer -->
        <footer class="mt-12 pt-8 border-t border-white/20 text-slate-200/70 text-sm">
            <div class="text-center">
                <p>&copy; <span id="current-year"></span> RandunLabz. All Rights Reserved.</p>
            </div>
        </footer>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // DOM Elements
            const courseForm = document.getElementById('course-form');
            const courseNameInput = document.getElementById('course-name');
            const creditsInput = document.getElementById('credits');
            const gradeInput = document.getElementById('grade');
            const courseList = document.getElementById('course-list');
            const gpaDisplay = document.getElementById('gpa-display');
            const gpaSummary = document.getElementById('gpa-summary');
            const emptyState = document.getElementById('empty-state');
            const downloadPdfBtn = document.getElementById('download-pdf-btn');

            // Application state
            let courses = [];

            const pointMap = {
                'A+': 4.0, 'A': 4.0, 'A-': 3.7, 'B+': 3.3, 'B': 3.0, 'B-': 2.7, 'C+': 2.3,
                'C': 2.0, 'C-': 1.7, 'D+': 1.3, 'D': 1.0, 'F': 0.0
            };

            // --- Core GPA Logic ---
            const renderCourses = () => {
                courseList.innerHTML = ''; // Clear list
                if (courses.length === 0) {
                    courseList.appendChild(emptyState);
                } else {
                    courses.forEach((course, index) => {
                        const courseElement = document.createElement('div');
                        courseElement.className = 'course-add-animation flex justify-between items-center bg-white/10 p-4 rounded-lg border border-white/20';
                        courseElement.dataset.index = index;
                        
                        const points = pointMap[course.grade];

                        courseElement.innerHTML = `
                            <div class="flex-grow">
                                <p class="font-semibold text-white">${course.name || 'Untitled Course'}</p>
                                <p class="text-sm text-slate-200/80">Credits: ${course.credits}</p>
                            </div>
                            <div class="text-right mr-4">
                                <p class="font-bold text-lg text-cyan-300">${course.grade}</p>
                                <p class="text-sm text-slate-200/80">${points.toFixed(1)} pts</p>
                            </div>
                            <button class="remove-btn text-slate-200/60 hover:text-red-400 transition-colors p-1">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                </svg>
                            </button>
                        `;
                        courseList.appendChild(courseElement);
                    });
                }
            };

            const calculateGPA = () => {
                if (courses.length === 0) {
                    gpaDisplay.textContent = '0.00';
                    gpaSummary.textContent = 'Based on 0 credits';
                    return;
                }

                const totalPoints = courses.reduce((sum, c) => sum + (pointMap[c.grade] * parseFloat(c.credits)), 0);
                const totalCredits = courses.reduce((sum, c) => sum + parseFloat(c.credits), 0);
                const gpa = totalCredits > 0 ? totalPoints / totalCredits : 0;

                gpaDisplay.textContent = gpa.toFixed(2);
                gpaSummary.textContent = `Based on ${totalCredits} credit${totalCredits !== 1 ? 's' : ''}`;
                
                gpaDisplay.classList.add('gpa-updated');
                gpaDisplay.addEventListener('animationend', () => {
                    gpaDisplay.classList.remove('gpa-updated');
                }, { once: true });
            };

            const addCourse = (e) => {
                e.preventDefault();
                const name = courseNameInput.value.trim();
                const credits = creditsInput.value;
                const grade = gradeInput.value;

                if (!credits || !grade) return;

                courses.push({ name, credits, grade });
                renderCourses();
                calculateGPA();
                courseForm.reset();
                courseNameInput.focus();
            };

            const removeCourse = (elementToRemove) => {
                const index = parseInt(elementToRemove.dataset.index, 10);
                
                elementToRemove.classList.add('course-remove-animation');
                elementToRemove.addEventListener('animationend', () => {
                    courses.splice(index, 1);
                    renderCourses();
                    calculateGPA();
                }, { once: true });
            };

            // --- PDF Generation ---
            const generatePDF = () => {
                if (courses.length === 0) {
                    alert("Please add at least one course to generate a report.");
                    return;
                }
                
                const originalBtnText = downloadPdfBtn.innerHTML;
                downloadPdfBtn.innerHTML = `
                    <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white inline-block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    Generating...
                `;
                downloadPdfBtn.disabled = true;

                // Temporarily create a style tag to make the captured content PDF-friendly (black text on white background)
                const pdfStyle = document.createElement('style');
                pdfStyle.innerHTML = `
                    #course-list-container.pdf-capture {
                        background: white !important;
                        padding: 1rem;
                    }
                    #course-list-container.pdf-capture * {
                        color: black !important;
                        text-shadow: none !important;
                    }
                    #course-list-container.pdf-capture .remove-btn {
                        display: none !important;
                    }
                    #course-list-container.pdf-capture .text-cyan-300 {
                        color: #227C9D !important; /* A dark cyan for the grade letter */
                    }
                `;
                document.head.appendChild(pdfStyle);


                const listToCapture = document.getElementById('course-list-container');
                listToCapture.classList.add('pdf-capture');
                
                html2canvas(listToCapture, { 
                    scale: 2 // Higher scale for better quality
                }).then(canvas => {
                    const imgData = canvas.toDataURL('image/png');
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF('p', 'mm', 'a4');
                    
                    const docWidth = doc.internal.pageSize.getWidth();
                    
                    doc.setFontSize(22);
                    doc.setTextColor('#333333');
                    doc.text('GPA Report', docWidth / 2, 20, { align: 'center' });
                    
                    doc.setFontSize(14);
                    doc.text(`Generated by RandunLabz`, docWidth / 2, 28, { align: 'center' });

                    doc.setLineWidth(0.5);
                    doc.line(20, 35, docWidth - 20, 35);

                    doc.setFontSize(16);
                    doc.text(`Cumulative GPA: ${gpaDisplay.textContent}`, 20, 45);
                    doc.setFontSize(12);
                    doc.setTextColor('#666666');
                    doc.text(gpaSummary.textContent, 20, 52);

                    const imgWidth = docWidth - 40;
                    const imgHeight = canvas.height * imgWidth / canvas.width;
                    
                    doc.addImage(imgData, 'PNG', 20, 65, imgWidth, imgHeight);

                    doc.save('RandunLabz_GPA_Report.pdf');
                    
                }).catch(err => {
                    console.error("Error generating PDF:", err);
                    alert("Sorry, an error occurred while generating the PDF.");
                }).finally(() => {
                    // Cleanup: remove the temporary class and style tag, and reset the button
                    listToCapture.classList.remove('pdf-capture');
                    document.head.removeChild(pdfStyle);
                    downloadPdfBtn.innerHTML = originalBtnText;
                    downloadPdfBtn.disabled = false;
                });
            };

            // --- Event Listeners ---
            courseForm.addEventListener('submit', addCourse);
            courseList.addEventListener('click', (e) => {
                const removeButton = e.target.closest('.remove-btn');
                if (removeButton) {
                    removeCourse(removeButton.closest('[data-index]'));
                }
            });
            downloadPdfBtn.addEventListener('click', generatePDF);

            // --- Initial Load ---
            document.getElementById('current-year').textContent = new Date().getFullYear();
            renderCourses();
            calculateGPA();
        });
    </script>
</body>
</html>
